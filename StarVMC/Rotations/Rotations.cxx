#include "Rotations.h"
using namespace std;
vector<rotm_t> fgRotations;
//________________________________________________________________________________
void rotm_t::Rotations() {
  // Name      Thet1    Phi1   Thet2    Phi2   Thet3    Phi3
  rotm_t rotI[] = {
    {"000D",   90.0,    0.0,   90.0,   90.0,    0.0,    0.0}, // "000D"  (x,y,z) = > ( x, y, z)
    {"XYZD",  -90.0,    0.0,   90.0,   90.0,    0.0,    0.0}, // "XYZD"  (x,y,z) = > (-x, y, z)
    {"XZXD",   90.0,    0.0,  -90.0,   90.0,    0.0,    0.0}, // "XZXD"  (x,y,z) = > ( x,-y, z)
    {"YZXD",  -90.0,    0.0,  -90.0,   90.0,    0.0,    0.0}, // "YZXD"  (x,y,z) = > (-x,-y, z)
    {"180X",   90.0,    0.0,  -90.0,   90.0,  180.0,    0.0}, // "180X"  (x,y,z) = > ( x,-y,-z)
    {"180R",   90.0,    0.0,   90.0,   90.0,  180.0,    0.0}, // "180R"  (x,y,z) = > ( x, y,-z)
    {"180D",  -90.0,    0.0,   90.0,   90.0,  180.0,    0.0}, // "180D"  (x,y,z) = > (-x, y,-z)
    {"180Y",   90.0,   90.0,  -90.0,    0.0,  180.0,    0.0}, // "180Y"  (x,y,z) = > (-y, x,-z)
    {"180Z",   90.0,   90.0,  -90.0,    0.0,    0.0,    0.0}, // "180Z"  (x,y,z) = > (-y, x, z)
    {"Z180",  -90.0,   90.0,   90.0,    0.0,    0.0,    0.0}, // "Z180"  (x,y,z) = > ( y,-x, z)
    {"ZSXD",   90.0,   90.0,  180.0,    0.0,   90.0,    0.0}, // "ZSXD"  (x,y,z) = > ( z, x,-y)
    {"90ZD",  -90.0,    0.0,    0.0,    0.0,   90.0,   90.0}, // "90ZD"  (x,y,z) = > (-x, z, y)
    {"90XD",   90.0,   90.0,    0.0,    0.0,   90.0,    0.0}, // "90XD"  (x,y,z) = > ( z, x, y)
    {"90DX",  -90.0,   90.0,  180.0,    0.0,   90.0,    0.0}, // "90DX"  (x,y,z) = > ( z,-x,-y)
    {"20XD",   90.0,   70.0,    0.0,    0.0,   90.0,  -20.0}, // "20XD"  (x,y,z) = > ( ?, ?, y)
    {"60XD",   90.0,  110.0,    0.0,    0.0,   90.0,   20.0}, // "60XD"  (x,y,z) = > ( ?, ?, y)
    {"90YZ",  -90.0,   90.0,  180.0,    0.0,   90.0,    0.0}, // "90YZ"  (x,y,z) = > ( z,-x,-y)
    {"90YD",    0.0,    0.0,   90.0,    0.0,   90.0,   90.0}, // "90YD"  (x,y,z) = > ( y, z, x)
    {"90YN",    0.0,    0.0,   90.0,  180.0,   90.0,  270.0}, // "90YD"  (x,y,z) = > (-y,-z, x)
    {"90XY",    0.0,    0.0,  -90.0,   90.0,   90.0,    0.0}, // "90XY"  (x,y,z) = > ( z,-y, x)
    {"XY90",    0.0,    0.0,   90.0,   90.0,   90.0,  180.0}, // "XY90"  (x,y,z) = > (-z, y, x)
    {"90YX",  180.0,    0.0,   90.0,   90.0,   90.0,    0.0}, // "90YX"  (x,y,z) = > ( z, y,-x)
    {"YXZ2",   90.0,   90.0,    0.0,    0.0,   90.0,    0.0}, // "YXZ2"  (x,y,z) = > ( z, x, y)
    {"YXZ3",  -90.0,   90.0,   90.0,    0.0,  180.0,    0.0}, // "YXZ3"  (x,y,z) = > ( y,-x,-z)
    {"YXZ4",  -90.0,   90.0,   90.0,    0.0,    0.0,    0.0}, // "YXZ4"  (x,y,z) = > ( y,-x, z)
    {"YXZ5",  -90.0,   90.0,  -90.0,    0.0,  180.0,    0.0}, // "YXZ5"  (x,y,z) = > (-y,-x,-z)
    {"YXZ6",   90.0,   90.0,   90.0,    0.0,    0.0,    0.0}, // "YXZ6"  (x,y,z) = > ( y, x, z)
    {"C001",   90.0,   11.25,  0.0,    0.0,   90.0,  281.25}, // "C001"  (x,y,z) = > ( ?, ?, y)
    {"C002",   90.0,   22.50,  0.0,    0.0,   90.0,  292.50}, // "C002"  (x,y,z) = > ( ?, ?, y)
    {"C003",   90.0,   33.75,  0.0,    0.0,   90.0,  303.75}, // "C003"  (x,y,z) = > ( ?, ?, y)
    {"C004",   90.0,   45.00,  0.0,    0.0,   90.0,  315.00}, // "C004"  (x,y,z) = > ( ?, ?, y)
    {"C005",   90.0,   56.25,  0.0,    0.0,   90.0,  326.25}, // "C005"  (x,y,z) = > ( ?, ?, y)
    {"C006",   90.0,   67.50,  0.0,    0.0,   90.0,  337.50}, // "C006"  (x,y,z) = > ( ?, ?, y)
    {"C007",   90.0,   78.75,  0.0,    0.0,   90.0,  348.75}, // "C007"  (x,y,z) = > ( ?, ?, y)
    {"C008",   90.0,  101.25,  0.0,    0.0,   90.0,   11.25}, // "C008"  (x,y,z) = > ( ?, ?, y)
    {"C009",   90.0,  112.50,  0.0,    0.0,   90.0,   22.50}, // "C009"  (x,y,z) = > ( ?, ?, y)
    {"C0-9",  -90.0,   67.50,-180.,   90.0,   90.0,  -22.50}, // "C0-9"  (x,y,z) = > ( ?, ?, y)
    {"C010",   90.0,  123.75,  0.0,    0.0,   90.0,   33.75}, // "C010"  (x,y,z) = > ( ?, ?, y)
    {"C-11",  -90.0,   45.00,-180.,   90.0,   90.0,  -45.00}, // "C-11"  (x,y,z) = > ( ?, ?, y)
    {"C011",   90.0,  135.00,  0.0,    0.0,   90.0,   45.00}, // "C011"  (x,y,z) = > ( ?, ?, y)
    {"C012",   90.0,  146.25,  0.0,    0.0,   90.0,   56.25}, // "C012"  (x,y,z) = > ( ?, ?, y)
    {"C013",   90.0,  157.50,  0.0,    0.0,   90.0,   67.50}, // "C013"  (x,y,z) = > ( ?, ?, y)
    {"C014",   90.0,  168.75,  0.0,    0.0,   90.0,   78.75}, // "C014"  (x,y,z) = > ( ?, ?, y)
    {"C015",   90.0,  180.00,  0.0,    0.0,   90.0,   90.00}, // "C015"  (x,y,z) = > ( ?, ?, y)
    {"C016",   90.0,  191.25,  0.0,    0.0,   90.0,  101.25}, // "C016"  (x,y,z) = > ( ?, ?, y)
    {"C017",   90.0,  202.50,  0.0,    0.0,   90.0,  112.50}, // "C017"  (x,y,z) = > ( ?, ?, y)
    {"C018",   90.0,  213.75,  0.0,    0.0,   90.0,  123.75}, // "C018"  (x,y,z) = > ( ?, ?, y)
    {"C019",   90.0,  225.00,  0.0,    0.0,   90.0,  135.00}, // "C019"  (x,y,z) = > ( ?, ?, y)
    {"C020",   90.0,  236.25,  0.0,    0.0,   90.0,  146.25}, // "C020"  (x,y,z) = > ( ?, ?, y)
    {"C021",   90.0,  247.50,  0.0,    0.0,   90.0,  157.50}, // "C021"  (x,y,z) = > ( ?, ?, y)
    {"C022",   90.0,  258.75,  0.0,    0.0,   90.0,  168.75}, // "C022"  (x,y,z) = > ( ?, ?, y)
    {"C023",   90.0,  270.00,  0.0,    0.0,   90.0,  180.00}, // "C023"  (x,y,z) = > ( ?, ?, y)
    {"C024",   90.0,  281.25,  0.0,    0.0,   90.0,  191.25}, // "C024"  (x,y,z) = > ( ?, ?, y)
    {"C025",   90.0,  292.50,  0.0,    0.0,   90.0,  202.50}, // "C025"  (x,y,z) = > ( ?, ?, y)
    {"C026",   90.0,  303.75,  0.0,    0.0,   90.0,  213.75}, // "C026"  (x,y,z) = > ( ?, ?, y)
    {"C027",   90.0,  315.00,  0.0,    0.0,   90.0,  225.00}, // "C027"  (x,y,z) = > ( ?, ?, y)
    {"C028",   90.0,  337.50,  0.0,    0.0,   90.0,  247.50}, // "C028"  (x,y,z) = > ( ?, ?, y)
    {"C029",   90.0,  326.25,  0.0,    0.0,   90.0,  236.25}, // "C029"  (x,y,z) = > ( ?, ?, y)
    {"C030",   90.0,  348.75,  0.0,    0.0,   90.0,  258.75}, // "C030"  (x,y,z) = > ( ?, ?, y)
    {"C031",   90.0,  360.00,180.0,    0.0,   90.0,  270.00}, // "C031"  (x,y,z) = > ( ?, ?,-y)
    {"C032",   90.0,   11.25,180.0,    0.0,   90.0,  101.25}, // "C032"  (x,y,z) = > ( ?, ?,-y)
    {"C033",   90.0,   22.50,180.0,    0.0,   90.0,  112.50}, // "C033"  (x,y,z) = > ( ?, ?,-y)
    {"C034",   90.0,   33.75,180.0,    0.0,   90.0,  123.75}, // "C034"  (x,y,z) = > ( ?, ?,-y)
    {"C035",   90.0,   45.00,180.0,    0.0,   90.0,  135.00}, // "C035"  (x,y,z) = > ( ?, ?,-y)
    {"C036",   90.0,   56.25,180.0,    0.0,   90.0,  146.25}, // "C036"  (x,y,z) = > ( ?, ?,-y)
    {"C037",   90.0,   67.50,180.0,    0.0,   90.0,  157.50}, // "C037"  (x,y,z) = > ( ?, ?,-y)
    {"C038",   90.0,   78.75,180.0,    0.0,   90.0,  168.75}, // "C038"  (x,y,z) = > ( ?, ?,-y)
    {"C039",   90.0,   90.00,180.0,    0.0,   90.0,  180.00}, // "C039"  (x,y,z) = > ( ?, ?,-y)
    {"C040",   90.0,  101.25,180.0,    0.0,   90.0,  191.25}, // "C040"  (x,y,z) = > ( ?, ?,-y)
    {"C041",   90.0,  112.50,180.0,    0.0,   90.0,  202.50}, // "C041"  (x,y,z) = > ( ?, ?,-y)
    {"C042",   90.0,  123.75,180.0,    0.0,   90.0,  213.75}, // "C042"  (x,y,z) = > ( ?, ?,-y)
    {"C043",   90.0,  135.00,180.0,    0.0,   90.0,  225.00}, // "C043"  (x,y,z) = > ( ?, ?,-y)
    {"C044",   90.0,  146.25,180.0,    0.0,   90.0,  236.25}, // "C044"  (x,y,z) = > ( ?, ?,-y)
    {"C045",   90.0,  157.50,180.0,    0.0,   90.0,  247.50}, // "C045"  (x,y,z) = > ( ?, ?,-y)
    {"C046",   90.0,  168.75,180.0,    0.0,   90.0,  258.75}, // "C046"  (x,y,z) = > ( ?, ?,-y)
    {"C047",   90.0,  180.00,180.0,    0.0,   90.0,  270.00}, // "C047"  (x,y,z) = > ( ?, ?,-y)
    {"C048",   90.0,  191.25,180.0,    0.0,   90.0,  281.25}, // "C048"  (x,y,z) = > ( ?, ?,-y)
    {"C049",   90.0,  202.50,180.0,    0.0,   90.0,  292.50}, // "C049"  (x,y,z) = > ( ?, ?,-y)
    {"C050",   90.0,  213.75,180.0,    0.0,   90.0,  303.75}, // "C050"  (x,y,z) = > ( ?, ?,-y)
    {"C051",   90.0,  225.00,180.0,    0.0,   90.0,  315.00}, // "C051"  (x,y,z) = > ( ?, ?,-y)
    {"C052",   90.0,  236.25,180.0,    0.0,   90.0,  326.25}, // "C052"  (x,y,z) = > ( ?, ?,-y)
    {"C053",   90.0,  247.50,180.0,    0.0,   90.0,  337.50}, // "C053"  (x,y,z) = > ( ?, ?,-y)
    {"C054",   90.0,  258.75,180.0,    0.0,   90.0,  348.75}, // "C054"  (x,y,z) = > ( ?, ?,-y)
    {"C055",   90.0,  270.00,180.0,    0.0,   90.0,    0.00}, // "C055"  (x,y,z) = > ( z,-x,-y)
    {"C056",   90.0,  281.25,180.0,    0.0,   90.0,   11.25}, // "C056"  (x,y,z) = > ( ?, ?,-y)
    {"C057",   90.0,  292.50,180.0,    0.0,   90.0,   22.50}, // "C057"  (x,y,z) = > ( ?, ?,-y)
    {"C058",   90.0,  303.75,180.0,    0.0,   90.0,   33.75}, // "C058"  (x,y,z) = > ( ?, ?,-y)
    {"C059",   90.0,  315.00,180.0,    0.0,   90.0,   45.00}, // "C059"  (x,y,z) = > ( ?, ?,-y)
    {"C060",   90.0,  326.25,180.0,    0.0,   90.0,   56.25}, // "C060"  (x,y,z) = > ( ?, ?,-y)
    {"C061",   90.0,  337.50,180.0,    0.0,   90.0,   67.50}, // "C061"  (x,y,z) = > ( ?, ?,-y)
    {"C062",   90.0,  348.75,180.0,    0.0,   90.0,   78.75}, // "C062"  (x,y,z) = > ( ?, ?,-y)
    {"C063",   90.0,    0.0,   0.0,    0.0,   90.0,   90.00}, // "C063"  (x,y,z) = > ( x, z, y)
    {"Z1YX",   90.0,   90.0,   0.0,    0.0,   90.0,    0.00}, // "Z1YX"  (x,y,z) = > ( z, x, y)
    {"Z2XY",   90.0,    0.0, 180.0,    0.0,   90.0,   90.00}, // "Z2XY"  (x,y,z) = > ( x, z,-y)
    {"Z3XY",  -90.0,    0.0,   0.0,    0.0,   90.0,   90.00}, // "Z3XY"  (x,y,z) = > (-x, z, y)
    {"Z4YX",   90.0,   90.0, 180.0,    0.0,  -90.0,    0.00}, // "Z4YX"  (x,y,z) = > (-z, x,-y)
    {"Z5YX",  -90.0,   90.0,   0.0,    0.0,  -90.0,    0.00}, // "Z5YX"  (x,y,z) = > (-z,-x, y)
    {"Z6XY",  -90.0,    0.0, 180.0,    0.0,  -90.0,   90.00}, // "Z6XY"  (x,y,z) = > (-x,-z,-y)
    {"Z7XY",   90.0,    0.0,   0.0,    0.0,  -90.0,   90.00}, // "Z7XY"  (x,y,z) = > ( x,-z, y)
    {"Z9XY",   90.0,    0.0,   0.0,    0.0,   90.0,  270.00}, // "Z9XY"  (x,y,z) = > ( x, z,-y)
    {"Z8YX",  -90.0,   90.0, 180.0,    0.0,   90.0,    0.00}, // "Z8YX"  (x,y,z) = > ( z,-x,-y)
    {"XXZY",   90.0,    0.0, 180.0,    0.0,   90.0,   90.00}, // "XXZY"  (x,y,z) = > ( x, z,-y)
    {"XZXY",   90.0,  180.0, 180.0,    0.0,   90.0,  -90.00}, // "XZXY"  (x,y,z) = > (-x,-z,-y)
    {"YZXZ",   90.0,   90.0,  90.0,    0.0,  180.0,    0.00}, // "YZXZ"  (x,y,z) = > ( y, x,-z)
    {"XXYZ",   90.0,  180.0,  90.0,  -90.0,    0.0,    0.00}, // "XXYZ"  (x,y,z) = > (-x,-y, z)
    {"XZYX",   90.0,    0.0,   0.0,    0.0,   90.0  ,-90.00}, // "XZYX"  (x,y,z) = > ( x,-z, y)
    {"22.5",   90.0,   22.5,  90.0,  112.5,    0.0,    0.00}, // "22.5"  (x,y,z) = > ( ?, ?, z)
    {"P270",  270.0,    0.0,  90.0,   90.0,  180.0,    0.00}, // "P270"  (x,y,z) = > (-x, y,-z)
    {"N270",  270.0,  180.0,  90.0,  270.0,  180.0,    0.00}, // "N270"  (x,y,z) = > ( x,-y,-z)
    {"D075",   75.0,    0.0,  90.0,   90.0,  -15.0,    0.00}, // "D075"  (x,y,z) = > ( ?, y, ?)
    {"D180",   90.0,    0.0, 180.0,   90.0,   90.0,   90.00}, // "D180"  (x,y,z) = > ( x, z,-y)
    {"D270",   90.0,    0.0, 270.0,   90.0,  180.0,   90.00}, // "D270"  (x,y,z) = > ( x,-y,-z)
    {"D060",  -90.0,   60.0,-180.0,   90.0,   90.0,  -30.00}, // "D060"  (x,y,z) = > ( ?, ?,-y)
    {"D120",   90.0,  120.0,   0.0,    0.0,   90.0,   30.00}, // "D120"  (x,y,z) = > ( ?, ?, y)
    {"D012",   90.0,   12.0,  90.0,  102.0,    0.0,    0.00}, // "D012"  (x,y,z) = > ( ?, ?, z)
    {"N012",   90.0,  -12.0,  90.0,   78.0,    0.0,    0.00}, // "N012"  (x,y,z) = > ( ?, ?, z)
    {"N045",  -90.0,   45.0,-180.0,   90.0,   90.0,  -45.00}, // "N045"  (x,y,z) = > ( ?, ?,-y)
    {"D045",   90.0,   45.0, 270.0,  135.0,  180.0,   90.00}, // "D045"  (x,y,z) = > ( ?, ?,-z)
    {"045N",   90.0,  -45.0, 270.0,   45.0,  180.0,   90.00}, // "045N"  (x,y,z) = > ( ?, ?,-z)
    {"045D",   90.0,  -45.0,  90.0,   45.0,    0.0,    0.00}, // "045D"  (x,y,z) = > ( ?, ?, z)
    {"054D",   90.0,   54.0,  90.0,  144.0,    0.0,    0.00}, // "054D"  (x,y,z) = > ( ?, ?, z)
    {"054N",   90.0,  -54.0,  90.0,   36.0,    0.0,    0.00}, // "054N"  (x,y,z) = > ( ?, ?, z)
    {"055D",   90.0,  55.35,  90.0, 145.35,    0.0,    0.00}, // "055D"  (x,y,z) = > ( ?, ?, z)
    {"055N",   90.0, -55.35,  90.0,  34.65,    0.0,    0.00}, // "055N"  (x,y,z) = > ( ?, ?, z)
    {"006N",   90.0,   -6.0,  90.0,   84.0,    0.0,    0.00}, // "006N"  (x,y,z) = > ( ?, ?, z)
    {"006D",   90.0,    6.0,  90.0,   96.0,    0.0,    0.00}, // "006D"  (x,y,z) = > ( ?, ?, z)
    {"075D",   90.0,   75.0, 270.0,  165.0,  180.0,   90.00}, // "075D"  (x,y,z) = > ( ?, ?,-z)
    {"075N",   90.0,  -75.0,  90.0,   15.0,    0.0,    0.00}, // "075N"  (x,y,z) = > ( ?, ?, z)
    {"180L",   90.0,   90.0, 180.0,    0.0,  270.0,    0.00}, // "180L"  (x,y,z) = > (-z, x,-y)
    {"270D",   90.0,   90.0, 270.0,  180.0,  180.0,   90.00}, // "270D"  (x,y,z) = > ( y, x,-z)
    {"090N",   90.0,  -90.0,  90.0,    0.0,    0.0,    0.00}, // "090N"  (x,y,z) = > ( y,-x, z)
    {"A015",  105.0,    0.0,  90.0,   90.0,   15.0,    0.00}, // "A015"  (x,y,z) = > ( ?, y, ?)
    {"A-15",   75.0,    0.0,  90.0,   90.0,  -15.0,    0.00}  // "A-15"  (x,y,z) = > ( ?, y, ?)
  };
  Int_t nrotm = sizeof(rotI)/sizeof(rotm_t); std::cout << "Total no. of rotaion matrices  = " << nrotm << std::endl;
#if 0
  for (int i = 0; i < nrotm; i++) {
    rotm_t &rotm = rotI[i];
    fgRotations.push_back(rotm);
  }
#else
  fgRotations = vector<rotm_t>(rotI,rotI+nrotm);
#endif
  // Rotations around Z with step 5 degrees "R???"
  Double_t phi;
  for (phi = 0; phi <= 360; phi += 5) {
    rotm_t rotm;
    sprintf(rotm.name,"R%03.0f",phi);
    rotm.Thet1 = 90;
    rotm.Phi1  = phi;
    rotm.Thet2 = 90;
    rotm.Phi2  = 90 + phi;
    if (rotm.Phi2 <    0) rotm.Phi2 += 360;
    if (rotm.Phi2 >= 360) rotm.Phi2 -= 360;
    rotm.Thet3 = 0.;
    rotm.Phi3  = 0.;
    fgRotations.push_back(rotm);
  }
  // Rotations around Z with step 22.5 degrees "R?.?"
  for (phi = 22.5; phi <= 360; phi += 45.) {
    rotm_t rotm;
    sprintf(rotm.name,"R%03.0f",phi);
    rotm.Thet1 = 90;
    rotm.Phi1  = phi;
    rotm.Thet2 = 90;
    rotm.Phi2  = 90 + phi;
    if (rotm.Phi2 <    0) rotm.Phi2 += 360;
    if (rotm.Phi2 >= 360) rotm.Phi2 -= 360;
    rotm.Thet3 = 0.;
    rotm.Phi3  = 0.;
    fgRotations.push_back(rotm);
  }
  // Flip (x,y,z) => ( x,-y,-z) and Rotate around Z with step 30 degrees
  for (phi = 0; phi < 360; phi += 30) {
    rotm_t rotm;
    sprintf(rotm.name,"Y%03.0f",phi);
    rotm.Thet1 = 90;
    rotm.Phi1  = phi;
    rotm.Thet2 = 90;
    rotm.Phi2  = -90 + phi;
    if (rotm.Phi2 <    0) rotm.Phi2 += 360;
    if (rotm.Phi2 >= 360) rotm.Phi2 -= 360;
    rotm.Thet3 = 180.;
    rotm.Phi3  =   0.;
    fgRotations.push_back(rotm);
  }
  // Flip (x,y,z) => ( x, y,-z) and Rotate around Z with step 5 degrees
  for (phi = -15; phi <= 360; phi += 5) {
    rotm_t rotm;
    sprintf(rotm.name,"%03.0fT",phi);
    rotm.Thet1 = 90;
    rotm.Phi1  = phi;
    rotm.Thet2 = 90;
    rotm.Phi2  = -90 + phi;
    if (rotm.Phi2 <    0) rotm.Phi2 += 360;
    if (rotm.Phi2 >= 360) rotm.Phi2 -= 360;
    rotm.Thet3 = 180.;
    rotm.Phi3  =   0.;
    fgRotations.push_back(rotm);
  }
#ifndef __NO_TGEO__
  nrotm = fgRotations.size(); std::cout << "Total no. of rotaion matrices  = " << nrotm << std::endl;
#if 0
  TGeoRotation *rr = 0;
  for (int i = 0; i < nrotm; i++) {
    rotm_t &rotm =  fgRotations[i];
    rr = rotm.GetRotM();
    if (gGeoManager) rr->RegisterYourself();
    if (! rr->IsValid()) {
      rotm.Print();
      rr->Print();
    }
  }
#endif
#endif /* ! __NO_TGEO__ */
}
